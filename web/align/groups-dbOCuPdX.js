function v(){const n=window.LiteGraph;if(n?.LGraphCanvas?.active_canvas){const s=n.LGraphCanvas.active_canvas;if(s?.graph)return{canvas:s,graph:s.graph}}const t=document.querySelector(".litegraph.litegraph-canvas")?.lgraphcanvas;return t?.graph?{canvas:t,graph:t.graph}:null}function z(){const n=window;return n.app?.canvas&&n.app?.graph?n.app:v()}function x(n){try{n?.graph?.setDirtyCanvas?.(!0,!0)}catch(e){console.warn("Failed to set dirty canvas",e)}}function A(n){if(!n)return[];const e=n?.canvas?.selected_nodes;if(Array.isArray(e)&&e.length)return Array.from(e);const t=n?.graph?._nodes;return Array.isArray(t)?t.filter(s=>s?.is_selected||s?.selected):[]}function w(n){return n.filter(e=>!e.flags?.pinned)}function _(n){if(!n)return[];const e=n?.canvas?.selected_groups;if(Array.isArray(e)&&e.length)return Array.from(e);const t=n?.graph?.groups;return Array.isArray(t)?t.filter(s=>s?.selected):[]}function r(n){if(Array.isArray(n.bounding)&&n.bounding.length>=4)return[n.bounding[0],n.bounding[1],n.bounding[2],n.bounding[3]];if(n.pos&&n.size)return[n.pos[0]??0,n.pos[1]??0,n.size[0]??0,n.size[1]??0];if(typeof n.x<"u"&&typeof n.y<"u"&&typeof n.width<"u"&&typeof n.height<"u")return[n.x||0,n.y||0,n.width||0,n.height||0];const e=n.pos_x??n.x??0,t=n.pos_y??n.y??0,s=n.size_x??n.width??n.size?.[0]??100,y=n.size_y??n.height??n.size?.[1]??100;return[e,t,s,y]}function b(n,e){if(!n||!e)return[];const t=n?.graph?._nodes||[],[s,y,o,l]=r(e);return t.filter(i=>{if(!i?.pos||!i?.size)return!1;const h=i.pos[0],a=i.pos[1],d=i.size[0],c=i.size[1];return h>=s&&a>=y&&h+d<=s+o&&a+c<=y+l})}function M(n,e,t,s=!0){const y=z(),[o,l,i,h]=r(n),a=e-o,d=t-l;if(a===0&&d===0)return;const c=s?b(y,n):[];if(Array.isArray(n.bounding)&&n.bounding.length>=4?(n.bounding[0]=e,n.bounding[1]=t,n.bounding[2]=i,n.bounding[3]=h):n.pos&&n.size?(n.pos[0]=e,n.pos[1]=t,n.size[0]=i,n.size[1]=h):typeof n.x<"u"&&typeof n.y<"u"&&typeof n.width<"u"&&typeof n.height<"u"?(n.x=e,n.y=t,n.width=i,n.height=h):(n.x=e,n.y=t,n.width=i,n.height=h,n.pos&&(n.pos[0]=e,n.pos[1]=t),n.size&&(n.size[0]=i,n.size[1]=h)),s&&c.length)for(const f of c)try{f.pos[0]=(f.pos[0]??0)+a,f.pos[1]=(f.pos[1]??0)+d}catch{}}function G(n,e,t,s,y){const[o,l,i,h]=r(n),a=Math.round(e),d=Math.round(t),c=Math.max(0,Math.round(s)),f=Math.max(0,Math.round(y));a===Math.round(o)&&d===Math.round(l)&&c===Math.round(i)&&f===Math.round(h)||(Array.isArray(n.bounding)&&n.bounding.length>=4?(n.bounding[0]=a,n.bounding[1]=d,n.bounding[2]=c,n.bounding[3]=f):n.pos&&n.size?(n.pos[0]=a,n.pos[1]=d,n.size[0]=c,n.size[1]=f):typeof n.x<"u"&&typeof n.y<"u"&&typeof n.width<"u"&&typeof n.height<"u"?(n.x=a,n.y=d,n.width=c,n.height=f):(n.x=a,n.y=d,n.width=c,n.height=f,n.pos&&(n.pos[0]=a,n.pos[1]=d),n.size&&(n.size[0]=c,n.size[1]=f)))}export{A as a,_ as b,w as c,r as d,G as e,z as g,M as m,x as s};
